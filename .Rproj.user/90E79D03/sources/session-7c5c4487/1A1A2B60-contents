#' Frequentist confidence interval following Shen et al. (2023), Econometrica
#' 
#' @param true the matrix of simulated values
#' @param estimate is the estimated matrix obtained in the calculation step 
#' We use this function just for synthetic control, sep vertical regression
#' and OLS
#' 
#' @autor Giulio Grossi
#' 
#'

ci_shen<-function(true, estimate){
  
error = true - estimate
se_treated=apply(error,2, sd)

for(i in 1:ncol(estimate)){
  up[,i] = estimate[,i] + 1.96*se_treated[i]
  low[,i] = estimate[,i] - 1.96*se_treated[i]
}

out=cbind(up, low)  
return(out)  
}