#' Bayesian confidence interval
#' 
#' @param est the list of posterior distributions from bayes methods
#' We use this function just for bayesian vertical reg, bayesian synthetic 
#' control
#' 
#' @autor Giulio Grossi
#' 


ci_bayes <- function(est, method){
  
  lower=matrix(nrow=time_periods, ncol=bands)
  upper=matrix(nrow=time_periods, ncol=bands)
  
  for(i in 1:bands){
    lower[,i]<-apply(est[[method]][[i]]$y_new,2,quantile, prob=0.025)
    upper[,i]<-apply(est[[method]][[i]]$y_new,2,quantile, prob=0.025)
  }
  
  out=list(lower, upper) 
  names(out)=c("lower_bound","upper_bound" )
  return(out)  
}
